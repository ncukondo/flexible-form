generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["multiSchema", "postgresqlExtensions"]
  binaryTargets   = ["native"]
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
}

model FormDefinition {
  id            String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  created_at     DateTime @default(now()) @db.Timestamptz(6)
  updated_at     DateTime @updatedAt @default(now())
  title         String
  actions       String[]
  source        String   @default("")
  form_definition       Json     @db.Json
  id_for_edit   String   @unique @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  id_for_view   String   @unique @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  id_for_extend String   @unique @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  
  // In supabase auth, the user id is uuid, but in other IdP like auth0, it is string.
  // auth.uid() may cause an error if it is not uuid, so use jwt()->>'sub' instead
  author_uid      String?  @default(dbgenerated("auth.jwt()->>'sub'")) 
}

